package org.onlineshop.controller;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import org.onlineshop.exception.CustomError;import org.onlineshop.model.Customer;import org.onlineshop.service.CustomerService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.security.core.annotation.AuthenticationPrincipal;import org.springframework.security.core.userdetails.User;import org.springframework.stereotype.Controller;import org.springframework.ui.Model;import org.springframework.web.bind.annotation.PathVariable;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.servlet.HandlerExceptionResolver;import org.springframework.web.servlet.ModelAndView;@Controller@RequestMapping("/customer/card")public class CartController implements HandlerExceptionResolver {    @Autowired    private CustomerService customerService;    @RequestMapping    public String getCard (@AuthenticationPrincipal User activeUser) {        Customer customer =  customerService.findCustomerByUsername(activeUser.getUsername());        long cartId = customer.getCart().getCartId();        return "redirect:/customer/card/" + cartId;    }    @RequestMapping("/{cartId}")    public String getCartRedirect(@PathVariable(value = "cartId") long cartId, Model model) {        model.addAttribute("cartId", cartId);        return "cart";    }    public ModelAndView resolveException(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) {        ModelAndView modelAndView = new ModelAndView();        CustomError error = new CustomError();        error.setMessage("Your request in not valid. Please Enter a valid request.");        modelAndView.addObject("customError", error);        modelAndView.addObject("error-page");        return modelAndView;    }}